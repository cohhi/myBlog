<!--    author:steam-404    -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>selenium手册</title>
    <link rel="stylesheet" href="../../../../prism/production/prism.css">
    <script src="../../../../prism/production/prism.js"></script>
    <link rel="stylesheet" href="default.css">
</head>
<body>
<div id="head">
    <a href="#api">基础API</a>
    <a href="#positioning">元素定位</a>
    <a href="#operation">元素操作</a>
    <a href="#alert">弹窗操作</a>
    <a href="#ScrollBar">滚动条</a>
    <a href="#mouseKeyboard">鼠标/键盘操作</a>
    <a href="#picture">图片操作</a>
    <a href="#iframe">iframe</a>
    <a href="#selector">下拉框</a>
</div>
<div id="content">
    <div id="api">
        <p>基础API</p>
        <pre>
            <code class="language-python">
                <script type="text/plain" class="language-markup">
webdriver.xxx()                 #驱动xxx浏览器

maximize_windows()              #最大化浏览器窗口
get_window_size()               #获取浏览器窗口大小
set_window_size()               #设置浏览器窗口大小
get_window_position()           #获取当前窗口的x,y位置
set_window_position()           #设置当前窗口的x,y位置

get()                           #请求url对应的响应
refresh()                       #刷新页面
forward()                       #前进一个页面
back()                          #后退一个页面

close()                         #关闭当前标签
quit()                          #关闭所有标签

current_url()                   #返回当前url
title                           #网页标题
get_screenshot_as_file()        #截屏
page_source                     #保存源码
                </script>
            </code>
        </pre>
    </div>
    <div id="positioning">
        <p>元素定位</p>
        <pre>
            <code class="language-python">
                <script type="text/plain" class="language-markup">
find_element_by_id()			#id定位
find_element_by_name()	    	#name定位
find_element_by_class_name()	#class定位
find_element_by_tag_name()  	#标签定位
find_element_by_link_text()     #根据内容定位
find_element_by_xpath('/')      #绝对路径   写上完整路径
find_element_by_xpath('//')     #相对路径  从任意位置查找
find_element_by_css_selector('标签[type="类型"]')  #css选择器


# id选择器
find_element(by=By.ID, value="id")
# name选择器
find_element(by=By.NAME, value="name")
# class选择器
find_element(by=By.CLASS_NAME, value="class")
# 标签选择器
find_element(by=By.TAG_NAME, value="标签")
# link选择器
find_element(by=By.LINK_TEXT, value="根据内容定位")
# 绝对定位选择器
find_element(by=By.XPATH, value="/")
# 相对定位选择器
find_element(by=By.LINK_TEXT, value="//")
# css选择器
find_element(by=By.CSS_SELECTOR, value="css")
                </script>
            </code>
        </pre>
    </div>
    <div id="operation">
        <p>元素操作</p>
        <pre>
            <code class="language-python">
                <script type="text/plain" class="language-markup">
click  			#点击
send_keys()  	#模拟键盘输入
clear()  		#将元素清空
size()   		#获取元素大小
text()     		#获取文本信息
get_attribute() #元素某个属性的值
is_enabled()    #元素是否可用
is_displayed()  #是否可见
is_selencted()  #选定状态
                </script>
            </code>
        </pre>
    </div>
    <div id="alert">
        <p>弹窗操作</p>
        <pre>
            <code class="language-python">
            <script type="text/plain" class="language-markup">
switch_to_alert()	#获取弹窗对象
text	   			#获取弹窗标题
send_keys           #向输入框写入内容
accept				#点击确认
dismiss				#点击取消
            </script>
        </code>
        </pre>
    </div>
    <div id="ScrollBar">
        <p>滚动条</p>
        <pre>
            <code class="language-python">
                <script type="text/plain" class="language-markup">
#selenium无法直接操作滚动条,但可以通过执行js代码操作滚动
#window.scrollTo(100,300) 向右滚动100,向下滚动300

code="window.scrollTo(100,300)"    #JavaScript代码
execute_script(code)               #执行js代码
                </script>
            </code>
        </pre>
    </div>
    <div id="mouseKeyboard">
        <p>鼠标/键盘操作</p>
        <pre>
            <code class="language-python">
                <script type="text/plain" class="language-markup">
#使用实例
from selenium import webdriver
from selenium.webdriver.common.action_chains import ActionChains
from selenium.webdriver.common.by import By
driver = webdriver.Chrome()
driver.get("http://411.free.svipss.top/blog/resources/applicationtest/resources/steam-404/steam-404Selenium.html")
# 创建鼠标操作对象
chains = ActionChains(driver)
# 选取元素
dbclick = driver.find_element(by=By.ID, value="dbclick")
# 单击鼠标左键
chains.click(dbclick).perform()
                </script>
            </code>
        </pre>
        <pre>
            <code class="language-python">
                <script type="text/plain" class="language-markup">
#鼠标操作

click()                                 #单击鼠标左键
click_and_hold()                        #按住鼠标左键
context_click()                         #点击鼠标右键
double_click()                          #双击鼠标左键
drag_and_drop(a,b)                      #拖拽到某个元素然后松开
drag_and_drop_by_offset(source, x, y)   #拖拽到某个坐标然后松开
move_by_offset(x, y)                    #鼠标从当前位置移动到某个坐标
move_to_element(to_element)             #鼠标移动到某个元素，悬浮
move_to_element_with_offset(to_element, x, y)   #移动到距某个元素（左上角坐标）多少距离的位置
perform()                               #执行链中的所有动作

#键盘操作
key_down(value, element=None)           #按下按键
key_up(value, element=None)             #松开按键
send_keys


release(on_element=None)                #在某个元素位置松开鼠标左键
send_keys(*keys_to_send)                #发送某个键到当前焦点的元素
send_keys_to_element(element, *keys_to_send)    #发送某个键到指定元素
                </script>
            </code>
        </pre>
    </div>
    <div id="picture">
        <p>图片操作</p>
        <h3>截图方法中不允许存在以下符号</h3>
        <h3>/ : * ? # ” < > | </h3>
        <pre>
            <code class="language-python">
                <script type="text/plain" class="language-markup">
driver.save_screenshot("xxx.png")                # 必须是.png图片
driver.get_screenshot_as_file( "/xxx.png")       #必须带路径 绝对/相对
driver.get_screenshot_as_png()                   # 返回二进制数据
driver.get_screenshot_as_base64()                # 返回base64加密后的数据
                </script>
            </code>
        </pre>
    </div>
    <div id="iframe">
        <p>重定向</p>
        <pre>
            <code class="language-python">
                <script type="text/plain" class="language-python">
switch_to.frame("id/name")      #id或name定位

switch_to.frame(1)              #下标方式切换

iframe = driver.find_element_by_tag_name("iframe")
driver.switch_to.frame(iframe)  #标签方式定位

iframe=driver.find_element_by_xpath("xpath")
driver.switch_to.frame(iframe)  #xpath方式定位

switch_to.default_content()     #切换回主页面

                </script>
            </code>
        </pre>
    </div>
    <div id="selector">
        <p>下拉框处理</p>
        <pre>
            <code class="language-python">
                <script type="text/plain" class="language-markup">
# 使用前需要引入
from selenium.webdriver.support.select import Select


# 包装select元素
selectMessage=Select(select元素)

# 索引选择器
selectMessage.select_by_index(1)

# value值选择器
selectMessage.select_by_value("optionC")

# 内容选择器
selectMessage.select_by_visible_text("C")
                </script>
            </code>
        </pre>
    </div>
</div>
<div id="end">
</div>
</body>
</html>